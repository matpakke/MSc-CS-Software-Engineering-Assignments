<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบจัดการสินค้าคงคลัง: กรณีศึกษาร้านไพโรจน์พลาสติก</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Sarabun', sans-serif;
            background-color: #f4f7f6;
        }
        .main-header {
            background-color: #0d6efd; /* Primary Blue */
            color: white;
            padding: 1.5rem 0;
            border-bottom: 5px solid #0a58ca;
        }
        .main-header h1 {
            font-weight: 700;
        }
        .content-section {
            background: #ffffff;
            padding: 2.5rem;
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0,0,0,0.07);
            margin-top: 2rem;
        }
        .nav-tabs .nav-link {
            font-weight: 500;
            color: #495057;
        }
        .nav-tabs .nav-link.active {
            color: #0d6efd;
            border-color: #dee2e6 #dee2e6 #fff;
            border-bottom-width: 3px;
            font-weight: 700;
        }
        
        /* Analysis Section Styles */
        #analysisSection {
            text-align: justify;
            line-height: 1.9;
            font-size: 1.1rem;
        }
        #analysisSection h3 {
            color: #0d6efd;
            font-weight: 700;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
            margin-top: 1.5rem;
        }
        #analysisSection p {
            text-indent: 1.5em; /* ย่อหน้า */
        }
        #analysisSection ul {
            padding-left: 2.5em;
        }
        
        /* App Simulation Styles */
        .stat-card {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-left-width: 5px;
            border-radius: 8px;
        }
        .stat-card-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: #6c757d;
            text-transform: uppercase;
        }
        .stat-card-value {
            font-size: 1.75rem;
            font-weight: 700;
        }
        .table-responsive {
            margin-top: 1.5rem;
        }
        .form-add-item {
            background-color: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
        }
        .total-footer td {
            font-weight: 700;
            font-size: 1.1rem;
        }
    </style>
</head>
<body>

    <header class="main-header text-center">
        <div class="container">
            <h1 class="display-5"><i class="bi bi-box-seam-fill"></i> ระบบจัดการสินค้าคงคลัง</h1>
            <p class="lead">กรณีศึกษาร้านไพโรจน์พลาสติก (ฉบับจำลองและบทวิเคราะห์)</p>
        </div>
    </header>

    <div class="container my-4">
        
        <ul class="nav nav-tabs" id="myTab" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="app-tab" data-bs-toggle="tab" data-bs-target="#appSection" type="button" role="tab" aria-controls="appSection" aria-selected="true">
                    <i class="bi bi-display-fill"></i> แอปพลิเคชันจำลอง
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="analysis-tab" data-bs-toggle="tab" data-bs-target="#analysisSection" type="button" role="tab" aria-controls="analysisSection" aria-selected="false">
                    <i class="bi bi-pencil-square"></i> บทวิเคราะห์งานวิจัย (500 คำ)
                </button>
            </li>
        </ul>

        <div class="tab-content">
            
            <div class="tab-pane fade show active" id="appSection" role="tabpanel" aria-labelledby="app-tab">
                <div class="content-section">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h2><i class="bi bi-boxes"></i> จัดการสินค้า</h2>
                        <button class="btn btn-success" data-bs-toggle="modal" data-bs-target="#addItemModal">
                            <i class="bi bi-plus-circle-fill"></i> เพิ่มสินค้าใหม่
                        </button>
                    </div>
                    
                    [cite_start]<p>ส่วนนี้จำลองหน้า "จัดการสินค้า" (ภาพที่ 6) [cite: 301] [cite_start]และ "จัดการสั่งซื้อ" (ภาพที่ 8) [cite: 342] ของผู้ดูแลระบบ</p>
                    
                    <div class="row g-3 mb-4">
                        <div class="col-md-4">
                            <div class="stat-card border-primary p-3">
                                <div class="stat-card-title">จำนวนรายการ (SKU)</div>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="stat-card-value text-primary" id="stat-sku-count">3</span>
                                    <i class="bi bi-box-seam h1 text-primary-light"></i>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stat-card border-success p-3">
                                <div class="stat-card-title">น้ำหนักรวมในคลัง (KG)</div>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="stat-card-value text-success" id="stat-total-weight">400.00</span>
                                    <i class="bi bi-truck h1 text-success-light"></i>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stat-card border-warning p-3">
                                <div class="stat-card-title">มูลค่ารวมในคลัง (บาท)</div>
                                <div class="d-flex justify-content-between align-items-center">
                                    <span class="stat-card-value text-warning" id="stat-total-value">16,500.00</span>
                                    <i class="bi bi-cash-stack h1 text-warning-light"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="table-responsive">
                        <table class="table table-striped table-hover align-middle">
                            <thead class="table-dark">
                                <tr>
                                    <th scope="col">รหัสสินค้า (SKU)</th>
                                    <th scope="col">ชื่อสินค้า</th>
                                    <th scope="col">ประเภท</th>
                                    <th scope="col">จำนวน (kg)</th>
                                    <th scope="col">ราคา/kg (บาท)</th>
                                    <th scope="col">มูลค่ารวม</th>
                                    <th scope="col" class="text-center">จัดการ</th>
                                </tr>
                            </thead>
                            <tbody id="inventoryTableBody">
                                <tr>
                                    <td>ABS-R-VO</td>
                                    <td>พลาสติก ABS</td>
                                    <td>พลาสติก</td>
                                    <td>100.00</td>
                                    <td>70.50</td>
                                    <td>7,050.00</td>
                                    <td class="text-center">
                                        <button class="btn btn-sm btn-outline-warning" onclick="alert('จำลองการแก้ไข')"><i class="bi bi-pencil"></i></button>
                                        <button class="btn btn-sm btn-outline-danger" onclick="deleteItem(this)"><i class="bi bi-trash"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>HDPE</td>
                                    <td>พลาสติก HDPE</td>
                                    <td>พลาสติก</td>
                                    <td>250.00</td>
                                    <td>35.00</td>
                                    <td>8,750.00</td>
                                    <td class="text-center">
                                        <button class="btn btn-sm btn-outline-warning" onclick="alert('จำลองการแก้ไข')"><i class="bi bi-pencil"></i></button>
                                        <button class="btn btn-sm btn-outline-danger" onclick="deleteItem(this)"><i class="bi bi-trash"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <td>PP-001</td>
                                    <td>พลาสติก PP</td>
                                    <td>พลาสติก</td>
                                    <td>50.00</td>
                                    <td>14.00</td>
                                    <td>700.00</td>
                                    <td class="text-center">
                                        <button class="btn btn-sm btn-outline-warning" onclick="alert('จำลองการแก้ไข')"><i class="bi bi-pencil"></i></button>
                                        <button class="btn btn-sm btn-outline-danger" onclick="deleteItem(this)"><i class="bi bi-trash"></i></button>
                                    </td>
                                </tr>
                            </tbody>
                            <tfoot class="table-group-divider total-footer">
                                <tr>
                                    <td colspan="3" class="text-end">รวมทั้งหมด:</td>
                                    <td id="footer-total-weight">400.00 kg</td>
                                    <td></td>
                                    <td id="footer-total-value" class="text-success">16,500.00 บาท</td>
                                    <td></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            </div>

            <div class="tab-pane fade" id="analysisSection" role="tabpanel" aria-labelledby="analysis-tab">
                <div class="content-section">
                    <h2 class="mb-4 text-primary"><i class="bi bi-lightbulb-fill"></i> บทวิเคราะห์และข้อคิดเห็นต่องานวิจัย</h2>
                    [cite_start]<p>งานวิจัยเรื่อง "การพัฒนาเว็บแอปพลิเคชันในการจัดการสินค้าคงคลัง: กรณีศึกษาร้านไพโรจน์พลาสติก" [cite: 3] [cite_start]นำเสนอการแก้ปัญหาทางธุรกิจที่คลาสสิกและพบเห็นได้บ่อยในธุรกิจ SME ไทย คือการเปลี่ยนผ่านจากระบบการทำงานแบบดั้งเดิม (การจดบันทึกด้วยมือ) [cite: 29] ไปสู่ระบบดิจิทัล (เว็บแอปพลิเคชัน) งานเขียนนี้มิได้มีจุดประสงค์เพื่อสรุปย่อเนื้อหา แต่เป็นการวิพากษ์และแสดงความคิดเห็นในแง่มุมที่น่าสนใจของกระบวนการวิจัยและผลลัพธ์ที่ได้</p>

                    <h3>สิ่งที่น่าสนใจที่สุดเกี่ยวกับงานวิจัยดังกล่าวคืออะไร</h3>
                    [cite_start]<p>ความน่าสนใจที่สุดของงานวิจัยนี้ ไม่ใช่แค่การสร้างระบบสต็อกสินค้า แต่คือการที่ผู้วิจัยได้ออกแบบระบบให้มีผู้ใช้งานถึง 3 กลุ่ม ได้แก่ ผู้ดูแลระบบ, พนักงาน และ **ลูกค้า** [cite: 86, 88] [cite_start]การมีอยู่ของ "ลูกค้า" ในฐานะผู้ใช้งานระบบ [cite: 88] [cite_start](ซึ่งได้รับการประเมินความพึงพอใจถึง 24 คน [cite: 14, 48][cite_start]) ได้เปลี่ยนโฉมของโปรเจกต์นี้จาก "ระบบจัดการคลังสินค้าภายใน (Internal Inventory System)" ไปเป็น "ระบบ E-commerce (B2B/B2C) ขนาดเล็ก" ที่เชื่อมโยงสต็อกจริงเข้ากับการสั่งซื้อของลูกค้าโดยตรง [cite: 88, 418] [cite_start]ดังจะเห็นได้จากหน้า "รายการสั่งซื้อของฉัน" (ภาพที่ 12) [cite: 469] นี่คือการแก้ปัญหาที่ตรงจุดและชาญฉลาด เพราะไม่ใช่แค่จัดการสต็อกหลังบ้าน แต่ยังเปิดช่องทางการขายใหม่ที่เชื่อมโยงกับข้อมูลจริงในคลังทันที</p>

                    <h3>สมมติฐานใดมีความสำคัญที่สุดในการวิเคราะห์</h3>
                    [cite_start]<p>สมมติฐานที่สำคัญที่สุด (และอาจเป็นจุดเปราะบางที่สุด) ของงานวิจัยนี้ คือการเลือกใช้ **"แบบจำลองน้ำตก (Waterfall Model)"** [cite: 39] [cite_start]ในการพัฒนาระบบ (SDLC) สมมติฐานหลักของโมเดลนี้คือ **"ความต้องการของระบบ (Requirements) สามารถถูกกำหนดได้อย่างครบถ้วนและชัดเจนตั้งแต่เริ่มต้น และจะไม่เปลี่ยนแปลงระหว่างการพัฒนา"** [cite: 39] [cite_start]ผู้วิจัยตั้งสมมติฐานว่า การวิเคราะห์ความต้องการในขั้นตอนที่ 1 [cite: 40, 47] [cite_start]นั้นเพียงพอและถูกต้อง 100% ก่อนที่จะลงมือออกแบบ (ขั้นตอนที่ 2) [cite: 41, 53] [cite_start]และพัฒนา (ขั้นตอนที่ 3) [cite: 42, 260] โดยไม่มีกระบวนการย้อนกลับไปแก้ไขความต้องการในระหว่างทางที่ชัดเจน</p>
                    
                    <h3>มีข้อควรสังเกตในสมมติฐานใดบ้าง</h3>
                    [cite_start]<p>ข้อควรสังเกตในสมมติฐานเรื่อง "ความต้องการที่คงที่" (Fixed Requirements) จากการใช้ Waterfall Model คือความเสี่ยงในโลกความเป็นจริง ธุรกิจ SME เช่น ร้านไพโรจน์พลาสติก มักมีความต้องการที่ "งอก" หรือ "เปลี่ยน" ระหว่างทางเสมอ (Dynamic Requirements) เช่น เจ้าของร้านอาจเพิ่งนึกได้ว่าต้องการรายงานสรุปยอดขายแบบใหม่ หลังจากที่ทีมพัฒนาได้เริ่มเขียนโค้ดไปแล้ว โมเดลน้ำตกไม่ยืดหยุ่นพอที่จะรับมือการเปลี่ยนแปลงนี้ [cite: 39] [cite_start]นอกจากนี้ งานวิจัยยังตั้งสมมติฐานในการวัดผลว่า "ความพึงพอใจ (Satisfaction)" [cite: 14] [cite_start]เทียบเท่ากับ "ความสำเร็จ (Success)" ของระบบ แม้ระบบจะได้คะแนนความพึงพอใจในระดับ "มากที่สุด" ($\overline{X}=4.58$ ด้านประสิทธิภาพ) [cite: 14, 484] [cite_start]แต่ก็ยังขาดการวัดผลเชิงปริมาณ (Quantitative) ที่พิสูจน์ว่าระบบใหม่นี้ช่วย "ลดความคลาดเคลื่อน" หรือ "แก้ปัญหาพื้นที่จัดเก็บไม่เพียงพอ" [cite: 29] ได้จริงตามปัญหาที่ตั้งไว้ในบทนำหรือไม่</p>

                    <h3>ข้อสรุปของผู้เขียนในงานวิจัยดังกล่าว มีความชอบธรรมหรือไม่อย่างไร</h3>
                    [cite_start]<p>ข้อสรุปของผู้วิจัยที่ว่า "เว็บแอปพลิเคชัน...ที่พัฒนาขึ้นผู้ใช้งานมีความพึงพอใจมากที่สุดในการใช้งาน" [cite: 14, 503] [cite_start]นั้น **มีความชอบธรรมอย่างยิ่ง ภายใต้ขอบเขตของวัตถุประสงค์ที่ตั้งไว้** เนื่องจากวัตถุประสงค์ข้อที่ 2 คือ "เพื่อประเมินความพึงพอใจของผู้ใช้งาน" [cite: 36] [cite_start]และผลการประเมินจากตารางที่ 1, 2, และ 3 ก็แสดงให้เห็นคะแนนเฉลี่ยที่สูงมากอย่างชัดเจน (เช่น $\overline{X}=4.58$ ด้านประสิทธิภาพ, $\overline{X}=4.52$ ด้านการสนับสนุน) [cite: 492, 496] [cite_start]อย่างไรก็ตาม ดังที่กล่าวไปแล้ว ข้อสรุปนี้ชอบธรรมในแง่ของ "ความพึงพอใจ" แต่ยังไม่ได้พิสูจน์ความชอบธรรมในแง่ของ "การแก้ปัญหาทางธุรกิจ" ได้อย่างสมบูรณ์ ซึ่งผู้วิจัยเองก็ตระหนักถึงข้อจำกัดนี้และได้ให้ข้อเสนอแนะว่าควรมีการประเมิน "ค่าความเชื่อมั่นของแบบประเมิน" ในครั้งต่อไป [cite: 501]</p>

                    <h3>จะสามารถปรับใช้ความรู้จากงานวิจัยดังกล่าวกับอาชีพในอนาคตได้อย่างไร</h3>
                    <p>งานวิจัยนี้เปรียบเสมือน "พิมพ์เขียว" ชั้นดีสำหรับการทำงานจริงในสายงานเทคโนโลยีสารสนเทศ ไม่ว่าจะเป็น Developer หรือ Business Analyst สิ่งที่ได้เรียนรู้คือ:
                    <ul>
                        [cite_start]<li><strong>การแก้ปัญหาแบบครบวงจร (End-to-End Solution):</strong> ไม่ใช่แค่ทำระบบสต็อก แต่ต้องคิดต่อไปว่าสต็อกนั้นจะเชื่อมโยงกับใคร (ลูกค้า) [cite: 88] และจะสร้างมูลค่าเพิ่ม (การสั่งซื้อ) ได้อย่างไร</li>
                        [cite_start]<li><strong>ความสำคัญของการออกแบบ (Design Matters):</strong> งานวิจัยนี้แบ่งการออกแบบ UI/UX (Input/Output Design) [cite: 89, 118] [cite_start]และการออกแบบฐานข้อมูล (ERD) [cite: 156, 259] ไว้อย่างชัดเจน แสดงให้เห็นว่าการวางแผนที่ดีก่อนลงมือเขียนโค้ดเป็นสิ่งจำเป็น</li>
                        [cite_start]<li><strong>การตระหนักรู้ในข้อจำกัดของเครื่องมือ:</strong> การที่ผู้วิจัยให้ข้อเสนอแนะเรื่อง "การออกแบบหน้าจอให้สอดคล้อง...กับอุปกรณ์มือถือ" (Responsive Design) [cite: 501] เป็นการตอกย้ำว่า แม้โปรเจกต์จะสำเร็จในวันนี้ แต่เราต้องมองไปถึงความต้องการในอนาคต (เช่น การใช้งานผ่านมือถือ) และเลือกใช้เทคโนโลยีหรือแนวทางปฏิบัติที่ทันสมัย (เช่น การใช้ CSS Framework สมัยใหม่ หรือการพัฒนาแบบ Agile) เพื่อรองรับการเติบโตของธุรกิจต่อไป</li>
                    </ul>
                    </p>
                </div>
            </div>

        </div>
    </div> <div class="modal fade" id="addItemModal" tabindex="-1" aria-labelledby="addItemModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <form id="addItemForm">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addItemModalLabel"><i class="bi bi-plus-circle-fill"></i> เพิ่มสินค้าใหม่</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="itemSku" class="form-label">รหัสสินค้า (SKU)</label>
                            <input type="text" class="form-control" id="itemSku" placeholder="เช่น PET-001" required>
                        </div>
                        <div class="mb-3">
                            <label for="itemName" class="form-label">ชื่อสินค้า</label>
                            <input type="text" class="form-control" id="itemName" placeholder="เช่น พลาสติก PET" required>
                        </div>
                        <div class="mb-3">
                            <label for="itemType" class="form-label">ประเภทสินค้า</label>
                            <input type="text" class="form-control" id="itemType" value="พลาสติก" required>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="itemQuantity" class="form-label">จำนวน (kg)</label>
                                <input type="number" class="form-control" id="itemQuantity" placeholder="1000" min="0" step="0.01" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="itemPrice" class="form-label">ราคา/kg (บาท)</label>
                                <input type="number" class="form-control" id="itemPrice" placeholder="25.50" min="0" step="0.01" required>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ปิด</button>
                        <button type="submit" class="btn btn-primary">ยืนยัน</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    

    <footer class="text-center text-muted p-4" style="background-color: #e9ecef;">
        [cite_start]<p class="mb-0">จำลองระบบและบทวิเคราะห์จาก: <strong>การพัฒนาเว็บแอปพลิเคชันในการจัดการสินค้าคงคลัง: กรณีศึกษาร้านไพโรจน์พลาสติก</strong> [cite: 3]</p>
        [cite_start]<p class="mb-0">วารสารวิจัยและนวัตกรรมทางวิทยาศาสตร์และเทคโนโลยี ปีที่ 5 ฉบับที่ 1 [cite: 1]</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    
    <script>
        // ใช้ Event Listener เพื่อให้แน่ใจว่า DOM โหลดเสร็จก่อนเริ่มทำงาน
        document.addEventListener('DOMContentLoaded', function () {
            
            const addItemForm = document.getElementById('addItemForm');
            const inventoryTableBody = document.getElementById('inventoryTableBody');
            const addItemModal = new bootstrap.Modal(document.getElementById('addItemModal'));

            // เพิ่ม Event Listener ให้กับฟอร์ม
            addItemForm.addEventListener('submit', function (e) {
                e.preventDefault(); // ป้องกันการรีเฟรชหน้า

                // 1. ดึงข้อมูลจากฟอร์ม
                const sku = document.getElementById('itemSku').value;
                const name = document.getElementById('itemName').value;
                const type = document.getElementById('itemType').value;
                const quantity = parseFloat(document.getElementById('itemQuantity').value);
                const price = parseFloat(document.getElementById('itemPrice').value);
                const totalValue = (quantity * price);

                // 2. สร้างแถวใหม่ในตาราง
                const newRow = document.createElement('tr');
                newRow.innerHTML = `
                    <td>${sku}</td>
                    <td>${name}</td>
                    <td>${type}</td>
                    <td>${quantity.toFixed(2)}</td>
                    <td>${price.toFixed(2)}</td>
                    <td>${totalValue.toFixed(2)}</td>
                    <td class="text-center">
                        <button class="btn btn-sm btn-outline-warning" onclick="alert('จำลองการแก้ไข')"><i class="bi bi-pencil"></i></button>
                        <button class="btn btn-sm btn-outline-danger" onclick="deleteItem(this)"><i class="bi bi-trash"></i></button>
                    </td>
                `;

                // 3. เพิ่มแถวใหม่ลงในตาราง
                inventoryTableBody.appendChild(newRow);

                // 4. อัปเดตข้อมูลสรุป
                updateTotals();

                // 5. รีเซ็ตฟอร์มและปิด Modal
                addItemForm.reset();
                addItemModal.hide();
            });
            
            // เริ่มการคำนวณผลรวมครั้งแรกเมื่อโหลดหน้า
            updateTotals();
        });

        // ฟังก์ชันสำหรับลบแถว (ต้องอยู่นอก DOMContentLoaded เพื่อให้ onclick เรียกได้)
        function deleteItem(button) {
            if (confirm('คุณแน่ใจหรือไม่ว่าต้องการลบสินค้ารายการนี้?')) {
                const row = button.closest('tr');
                row.parentNode.removeChild(row);
                updateTotals(); // อัปเดตผลรวมหลังจากลบ
            }
        }

        // ฟังก์ชันสำหรับอัปเดตผลรวม (Dashboard Cards และ Table Footer)
        function updateTotals() {
            const rows = document.getElementById('inventoryTableBody').querySelectorAll('tr');
            
            let totalWeight = 0;
            let totalValue = 0;
            const skuCount = rows.length;

            rows.forEach(row => {
                const cells = row.querySelectorAll('td');
                if (cells.length > 0) {
                    totalWeight += parseFloat(cells[3].innerText);
                    totalValue += parseFloat(cells[5].innerText);
                }
            });
            
            // Format ตัวเลข
            const numberFormatter = new Intl.NumberFormat('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 });

            // 1. อัปเดต Dashboard Cards
            document.getElementById('stat-sku-count').innerText = skuCount;
            document.getElementById('stat-total-weight').innerText = numberFormatter.format(totalWeight);
            document.getElementById('stat-total-value').innerText = numberFormatter.format(totalValue);
            
            // 2. อัปเดต Table Footer
            document.getElementById('footer-total-weight').innerText = `${numberFormatter.format(totalWeight)} kg`;
            document.getElementById('footer-total-value').innerText = `${numberFormatter.format(totalValue)} บาท`;
        }
    </script>
</body>
</html>